name: Build Zed for Windows

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: windows-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v2

    - name: Setup Rust
      uses: MatteoH2O1999/setup-rust@v1.0.1

    - name: setup CMake
      uses: milliewalky/setup-cmake@v1
            
    - name: Windows SDK Install
      uses: ChristopheLav/windows-sdk-install@v1.0.3
      with:
        version-sdk: 26100

    #- name: Visual Studio shell
    #  uses: egor-tensin/vs-shell@v2

    - name: rust update
      run:
        rustup target add wasm32-wasip1
    - name: Build
      run:
        cargo run --release

    - name: Upload Artifact
      uses: actions/upload-artifact@v3
      with:
        name: zed-windows-build
        path: target/release/zed.exe
