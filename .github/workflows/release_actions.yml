on:
  release:
    types: [published]

jobs:
  discord_release:
    runs-on: ubuntu-latest
    steps:
    - name: Get appropriate URL
      id: get-appropriate-url
      run: |
        if [ "${{ github.event.release.prerelease }}" == "true" ]; then
          URL="https://zed.dev/releases/preview/latest"
        else
          URL="https://zed.dev/releases/stable/latest"
        fi
        echo "::set-output name=URL::$URL"

    - name: Discord Webhook Action
      uses: tsickert/discord-webhook@v5.3.0
      with:
        webhook-url: ${{ secrets.DISCORD_WEBHOOK_URL }}
        content: |
          ðŸ“£ Zed ${{ github.event.release.tag_name }} was just released!

          Restart your Zed or head to ${{ steps.get-appropriate-url.outputs.URL }} to grab it.

          ${{ github.event.release.body }}
