interface lsp {
    /// An LSP completion.
    record completion {
        label: string,
        label-details: option<completion-label-details>,
        detail: option<string>,
        kind: option<completion-kind>,
        insert-text-format: option<insert-text-format>,
    }

    /// The kind of an LSP completion.
    variant completion-kind {
        text,
        method,
        function,
        %constructor,
        field,
        variable,
        class,
        %interface,
        module,
        property,
        unit,
        value,
        %enum,
        keyword,
        snippet,
        color,
        file,
        reference,
        folder,
        enum-member,
        constant,
        struct,
        event,
        operator,
        type-parameter,
        other(s32),
    }

    /// Label details for an LSP completion.
    record completion-label-details {
        detail: option<string>,
        description: option<string>,
    }

    /// Defines how to interpret the insert text in a completion item.
    variant insert-text-format {
        plain-text,
        snippet,
        other(s32),
    }

    /// An LSP symbol.
    record symbol {
        kind: symbol-kind,
        name: string,
    }

    /// The kind of an LSP symbol.
    variant symbol-kind {
        file,
        module,
        namespace,
        %package,
        class,
        method,
        property,
        field,
        %constructor,
        %enum,
        %interface,
        function,
        variable,
        constant,
        %string,
        number,
        boolean,
        array,
        object,
        key,
        null,
        enum-member,
        struct,
        event,
        operator,
        type-parameter,
        other(s32),
    }

    /// Specifies the parameter format for virtual document content requests.
    ///
    /// Different language servers expect different parameter formats when requesting
    /// virtual document contents.
    variant virtual-document-param-kind {
        /// Send only the URI as a TextDocumentIdentifier: { "uri": "<uri>" }
        /// This is the most common format, used by servers like JDTLS.
        uri,
        /// Send the URI as a raw string directly (not wrapped).
        raw-uri,
        /// Send URI and position as TextDocumentPositionParams.
        /// Used by servers that need position context (e.g., rust-analyzer macro expansion).
        uri-with-position,
    }

    /// Configuration for handling virtual documents (non-file URIs like decompiled code)
    record virtual-document-config {
        /// The URI scheme to handle (e.g., "jdt" for jdt:// URIs)
        scheme: string,
        /// The LSP request method to call to get document contents (e.g., "java/classFileContents")
        content-request-method: string,
        /// The language name for syntax highlighting (e.g., "Java")
        language-name: string,
        /// The LSP language ID to use when registering the document (e.g., "java")
        language-id: string,
        /// The parameter format expected by the language server.
        /// Defaults to "uri" (TextDocumentIdentifier) if not specified.
        param-kind: option<virtual-document-param-kind>,
    }
}
