{
  "project": "async-app-result-removal",
  "description": "Remove Result from AsyncApp return types by moving app-alive checks to executor",
  "phases": [
    {
      "id": 1,
      "name": "Add Trampoline Check Infrastructure (macOS First)",
      "status": "completed",
      "tasks": [
        {
          "id": "1.1",
          "description": "Add MainThreadWeak<T> newtype with unsafe Send+Sync impls to platform.rs",
          "file": "crates/gpui/src/platform.rs",
          "status": "completed"
        },
        {
          "id": "1.2",
          "description": "Update RunnableMeta to use Option<MainThreadWeak<AppCell>> for app field",
          "file": "crates/gpui/src/platform.rs",
          "status": "completed"
        },
        {
          "id": "1.3",
          "description": "Update trampoline in Mac dispatcher to check app via unsafe upgrade() before run()",
          "file": "crates/gpui/src/platform/mac/dispatcher.rs",
          "status": "completed"
        },
        {
          "id": "1.4",
          "description": "Update tick() in Test dispatcher to check app via unsafe upgrade() before run()",
          "file": "crates/gpui/src/platform/test/dispatcher.rs",
          "status": "completed"
        },
        {
          "id": "1.5",
          "description": "Add ForegroundExecutor::spawn_with_app that accepts Weak<AppCell>",
          "file": "crates/gpui/src/executor.rs",
          "status": "completed"
        },
        {
          "id": "1.6",
          "description": "Update AsyncApp::spawn to pass self.app wrapped in MainThreadWeak",
          "file": "crates/gpui/src/app/async_context.rs",
          "status": "completed"
        },
        {
          "id": "1.7",
          "description": "Update AsyncWindowContext::spawn to pass app wrapped in MainThreadWeak",
          "file": "crates/gpui/src/app/async_context.rs",
          "status": "completed"
        },
        {
          "id": "1.8",
          "description": "Write unit test verifying task cancellation when app is dropped",
          "file": "crates/gpui/tests/task_cancellation.rs",
          "status": "completed"
        },
        {
          "id": "1.9",
          "description": "Write unit test for nested tasks both cancelling cleanly",
          "file": "crates/gpui/tests/task_cancellation.rs",
          "status": "completed"
        },
        {
          "id": "1.10",
          "description": "Create async_cancellation.rs example demonstrating behavior",
          "file": "crates/gpui/examples/async_cancellation.rs",
          "status": "completed"
        }
      ]
    },
    {
      "id": 2,
      "name": "Extend to Other Platforms",
      "status": "not_started",
      "tasks": [
        {
          "id": "2.1",
          "description": "Update trampoline function in Linux dispatcher to check app status before run()",
          "file": "crates/gpui/src/platform/linux/dispatcher.rs",
          "status": "not_started"
        },
        {
          "id": "2.2",
          "description": "Update trampoline function in Windows dispatcher to check app status before run()",
          "file": "crates/gpui/src/platform/windows/dispatcher.rs",
          "status": "not_started"
        }
      ]
    },
    {
      "id": 3,
      "name": "Update AsyncApp API & Remove AppContext::Result",
      "status": "not_started",
      "tasks": [
        {
          "id": "3.1",
          "description": "Rename update() -> Result<R> to try_update() -> Option<R>",
          "file": "crates/gpui/src/app/async_context.rs",
          "status": "not_started"
        },
        {
          "id": "3.2",
          "description": "Add new update() -> R that panics if app is gone",
          "file": "crates/gpui/src/app/async_context.rs",
          "status": "not_started"
        },
        {
          "id": "3.3",
          "description": "Apply try_/non-try pattern to read_entity and update_entity",
          "file": "crates/gpui/src/app/async_context.rs",
          "status": "not_started"
        },
        {
          "id": "3.4",
          "description": "Apply try_/non-try pattern to read_global and update_global",
          "file": "crates/gpui/src/app/async_context.rs",
          "status": "not_started"
        },
        {
          "id": "3.5",
          "description": "Apply try_/non-try pattern to read_window and update_window",
          "file": "crates/gpui/src/app/async_context.rs",
          "status": "not_started"
        },
        {
          "id": "3.6",
          "description": "Apply try_/non-try pattern to new, reserve_entity, insert_entity",
          "file": "crates/gpui/src/app/async_context.rs",
          "status": "not_started"
        },
        {
          "id": "3.7",
          "description": "Apply try_/non-try pattern to refresh, open_window, subscribe, has_global",
          "file": "crates/gpui/src/app/async_context.rs",
          "status": "not_started"
        },
        {
          "id": "3.8",
          "description": "Apply same changes to AsyncWindowContext",
          "file": "crates/gpui/src/app/async_context.rs",
          "status": "not_started"
        },
        {
          "id": "3.9",
          "description": "Remove type Result<T> associated type from AppContext trait",
          "file": "crates/gpui/src/gpui.rs",
          "status": "not_started"
        },
        {
          "id": "3.10",
          "description": "Update all AppContext trait method signatures to return R directly",
          "file": "crates/gpui/src/gpui.rs",
          "status": "not_started"
        },
        {
          "id": "3.11",
          "description": "Remove Flatten trait from gpui.rs",
          "file": "crates/gpui/src/gpui.rs",
          "status": "not_started"
        },
        {
          "id": "3.12",
          "description": "Update WeakEntity::update to remove Flatten bounds",
          "file": "crates/gpui/src/app/entity_map.rs",
          "status": "not_started"
        },
        {
          "id": "3.13",
          "description": "Update WeakEntity::read_with to remove Flatten bounds",
          "file": "crates/gpui/src/app/entity_map.rs",
          "status": "not_started"
        },
        {
          "id": "3.14",
          "description": "Update WeakEntity::update_in to remove Flatten bounds",
          "file": "crates/gpui/src/app/entity_map.rs",
          "status": "not_started"
        },
        {
          "id": "3.15",
          "description": "Update ExampleContext in eval crate to match new AppContext signature",
          "file": "crates/eval/src/example.rs",
          "status": "not_started"
        },
        {
          "id": "3.16",
          "description": "Update AsyncApp documentation",
          "file": "crates/gpui/src/app/async_context.rs",
          "status": "not_started"
        },
        {
          "id": "3.17",
          "description": "Run cargo test -p gpui",
          "file": null,
          "status": "not_started"
        },
        {
          "id": "3.18",
          "description": "Run ./script/clippy",
          "file": null,
          "status": "not_started"
        },
        {
          "id": "3.19",
          "description": "Verify async_cancellation example runs without panics",
          "file": "crates/gpui/examples/async_cancellation.rs",
          "status": "not_started"
        },
        {
          "id": "3.20",
          "description": "Manual test: close windows with pending tasks, verify no panics",
          "file": null,
          "status": "not_started"
        }
      ]
    }
  ],
  "future_work": {
    "brief": "async-app-result-removal-migration.md",
    "description": "Codebase migration to remove error handling from ~500+ callsites",
    "phases": ["Audit Cross-Boundary Awaits", "Codebase Migration", "Testing and Cleanup"]
  }
}
