allow-private-module-inception = true
avoid-breaking-exported-api = false
ignore-interior-mutability = [
    # Suppresses clippy::mutable_key_type, which is a false positive as the Eq
    # and Hash impls do not use fields with interior mutability.
    "agent_ui::context::AgentContextKey"
]
disallowed-methods = [
    { path = "std::process::Command::spawn", reason = "Spawning `std::process::Command` can block the current thread for an unknown duration", replacement = "smol::process::Command::spawn" },
    { path = "std::process::Command::output", reason = "Spawning `std::process::Command` can block the current thread for an unknown duration", replacement = "smol::process::Command::output" },
    { path = "std::process::Command::status", reason = "Spawning `std::process::Command` can block the current thread for an unknown duration", replacement = "smol::process::Command::status" },
    { path = "std::process::Command::stdin", reason = "`smol::process::Command::from()` does not preserve stdio configuration", replacement = "smol::process::Command::stdin" },
    { path = "std::process::Command::stdout", reason = "`smol::process::Command::from()` does not preserve stdio configuration", replacement = "smol::process::Command::stdout" },
    { path = "std::process::Command::stderr", reason = "`smol::process::Command::from()` does not preserve stdio configuration", replacement = "smol::process::Command::stderr" },
    { path = "smol::Timer::after", reason = "smol::Timer introduces non-determinism in tests", replacement = "gpui::BackgroundExecutor::timer" },
    { path = "serde_json::from_reader", reason = "Parsing from a buffer is much slower than first reading the buffer into a Vec/String, see https://github.com/serde-rs/json/issues/160#issuecomment-253446892. Use `serde_json::from_slice` instead." },
    { path = "serde_json_lenient::from_reader", reason = "Parsing from a buffer is much slower than first reading the buffer into a Vec/String, see https://github.com/serde-rs/json/issues/160#issuecomment-253446892, Use `serde_json_lenient::from_slice` instead." },
    { path = "cocoa::foundation::NSString::alloc", reason = "NSString must be autoreleased to avoid memory leaks. Use `ns_string()` helper instead." },
    { path = "std::path::Path::exists", reason = "Use the `Fs` abstraction instead to enable testing with FakeFs" },
    { path = "std::path::Path::try_exists", reason = "Use the `Fs` abstraction instead to enable testing with FakeFs" },
    { path = "std::path::Path::is_file", reason = "Use `Fs::is_file` instead to enable testing with FakeFs" },
    { path = "std::path::Path::is_dir", reason = "Use `Fs::is_dir` instead to enable testing with FakeFs" },
    { path = "std::path::Path::is_symlink", reason = "Use `Fs::metadata` instead to enable testing with FakeFs" },
    { path = "std::path::Path::metadata", reason = "Use `Fs::metadata` instead to enable testing with FakeFs" },
    { path = "std::path::Path::symlink_metadata", reason = "Use `Fs::metadata` instead to enable testing with FakeFs" },
    { path = "std::path::Path::canonicalize", reason = "Use `Fs::canonicalize` instead to enable testing with FakeFs" },
    { path = "std::path::Path::read_link", reason = "Use `Fs::read_link` instead to enable testing with FakeFs" },
    { path = "std::path::Path::read_dir", reason = "Use `Fs::read_dir` instead to enable testing with FakeFs" },
]
disallowed-types = [
    # { path = "std::collections::HashMap", replacement = "collections::HashMap" },
    # { path = "std::collections::HashSet", replacement = "collections::HashSet" },
    # { path = "indexmap::IndexSet", replacement = "collections::IndexSet" },
    # { path = "indexmap::IndexMap", replacement = "collections::IndexMap" },
]
