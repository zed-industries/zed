# Agent Panel

The Agent Panel provides you with a way to interact with LLMs.
You can use it for various tasks, such as generating code, asking questions about your code base, and general inquiries such as emails and documentation.

To open the Agent Panel, reach for the `agent: new thread` action in [the Command Palette](./getting-started#command-palette) or click the ✨ (sparkles) icon in the status bar.

If you're using the Agent Panel for the first time, you'll need to set up at least one LLM provider.
Check [the Configuration page](./configuration.md) for more details about how to do it.

## Overview

After you've configured some LLM providers, you're ready to start working with the agent panel.

Type at the message editor and hit `enter` to submit your prompt to the LLM.
If you need extra room to type, you can you can expand the message editor via ({#kb agent::ExpandMessageEditor}).

You should start to see the responses stream in with indications of which tools the AI is using to fulfill your prompt.
For example, if the AI chooses to perform an edit, you will see a card with the diff.

### Editing Messages

Any message that you send to the AI is editable.
You can click on the card that contains your message and re-submit it with an adjusted prompt and/or new pieces of context.

### Checkpoints

Every time the AI performs an edit, you should see a "Restore Checkpoint" button to the top of your message.
This allows you to return the state of your codebase to the one it was prior to that message's point.
This is usually valuable if the performed edit doesn't go to the right direction.

### Navigation

To quickly loop through recently opened threads, reach for the {#kb agent::ToggleNavigationMenu} binding, when focused on the panel's editor, or click the hamburger icon button at the top left of the panel to open the dropdown that shows you the six most recent interactions with the LLM.

The items in this menu work similarly to tabs, and closing them from there doesn't delete the thread; just takes them out of the recent list.

You can also view all historical conversations with the `View All` option from within the same menu or by reaching for the {#kb agent::OpenHistory} binding.

<!-- todo! - figure out where to put this extra content related to history -->

*********************

# Introducing Contexts

Contexts are like conversations in most assistant-like tools. A context is a collaborative tool for sharing information between you, your project, and the assistant/model.

The model can reference content from your active context in the assistant panel, but also elsewhere like the inline assistant.

### Saving and Loading Contexts

After you submit your first message, a name for your context is generated by the language model, and the context is automatically saved to your file system in

- `~/.config/zed/conversations` (macOS)
- `~/.local/share/zed/conversations` (Linux)
- `%LocalAppData%\Zed\conversations` (Windows)

You can access and load previous contexts by clicking on the history button in the top-left corner of the assistant panel.

![Viewing assistant history](https://zed.dev/img/assistant/assistant-history.png)

### Viewing Past Contexts

You can view all previous contexts by opening the `History` tab in the assistant panel.

Open the `History` using the menu in the top right of the assistant panel and choosing `History`.

*********************

### Reviewing Changes

If you are using a profile that includes write tools, and the agent has made changes to your project, you'll notice the agent panel surfaces the fact that edits have been applied.

You can click on the accordion bar that shows up right above the panel's editor see which files have been changed, or click `Review Changes` ({#kb agent::OpenAgentDiff}) to open a multi-buffer to review them.
Reviewing includes the option to accept or reject each edit, or accept or reject all edits.

Diffs with changes also appear in individual buffers.
So, if your active tab is already one that had changes, you'll see diffs with the same accept/reject controls as in the multi-buffer.

## Adding Context

Although Zed's agent is very efficient at reading through your codebase to autonomously pick up relevant files, directories, and others, manually adding context is still usually encouraged as a way to speed up and improve the AI's response quality.

If you have a tab open when triggering the Agent Panel, that tab will appear as a suggested context in form of a dashed button.
You can also add other forms of context, like files, rules, and directories, by either typing `@` or hitting the `+` icon button.

Images are also supported, and pasting them over in the panel's editor works.

### Token Usage

Zed surfaces how many tokens you are consuming for your currently active thread in the panel's toolbar.
Depending on how many pieces of context you add, your token consumption can grow rapidly.

With that in mind, once you get close to the model's context window, we'll display a banner on the bottom of the message editor offering to start a new thread with the current one summarized and added as context.
You can also do this at any time—once with an ongoing thread—via the "Agent Options" menu on the top right.

## Changing Models

After you've configured your LLM providers—either via [a custom API key](/ai/custom-api-keys.md) or through [Zed's hosted models](/ai/models.md)—you can switch between them by clicking on the model selector on the message editor or by hitting the {#kb assistant::ToggleModelSelector} keybinding.

## Using Tools

Unlike the previous version, the new Agent Panel supports tool calling, which largely enables agentic collaboration with AI.
Zed comes with several built-in tools that allows models to perform tasks such as searching through your codebase, editing files, running commands, and others.

You can also extend the set of available tools via [MCP Servers](/ai/mcp.md).

### Profiles

Profiles introduce a way to group tools.
Zed offers three built-in profiles and you can create how many custom ones as you want.

#### Built-in Profiles

- `Write`: A profile with tools to allow the LLM to write to your files and run terminal commands. This one essentially has all built-in tools turned on.
- `Ask`: A profile with read-only tools. Best for asking questions about your code base without the fear of the agent making changes.
- `Minimal`: A profile with no tools. Best for general conversations with the LLM where no knowledge of your code is necessary.

You can explore the exact tools enabled in each profile by clicking on the profile selector button > `Configure Profiles…` > the one you want to check out.

#### Custom Profiles

You may find yourself in a situation where the built-in profiles don't quite fit your specific needs.
Zed's Agent Panel allows for building custom profiles.

You can create new profile via the `Configure Profiles…` option in the profile selector.
From here, you can choose to `Add New Profile` or fork an existing one with your choice of tools and a custom profile name.

You can also override built-in profiles.
With a built-in profile selected, in the profile selector, navigate to `Configure Tools`, and select the tools you'd like.

Zed will store this profile in your settings using the same profile name as the default you overrode.

All custom profiles can be edited via the UI or by hand under the `assistant.profiles` key in your `settings.json` file.

### Model Support

Tool calling needs to be individually supported by each model and model provider.
Therefore, despite the presence of tools, some models may not have the ability to pick them up yet in Zed.
You should see a "No tools" disabled button if you select a model that fits this case.

We want to support all of them, though!
We may prioritize which ones to focus on based on popularity and user feedback, so feel free to help and contribute.

All [Zed's hosted models](/ai/models.md) support tool calling out-of-the-box.

### MCP Servers

Similarly to the built-in tools, some models may not support all tools included in a given MCP Server.
Zed's UI will inform about this via a warning icon that appears close to the model selector.

## Text Threads

"Text threads" present your conversation with the LLM in a different format—as raw text.
With text threads, you have full control over the conversation data.
You can remove and edit responses from the LLM, swap roles, and include more context earlier in the conversation.

For users who have been with us for some time, you'll notice that text threads are our original assistant panel—users love it for the control it offers.
We do not plan to deprecate text threads, but it should be noted that if you want the AI to write to your code base through tools, that's only available in the newer, and now default, "threads".

## Errors and Debugging

In case of any error or strange LLM response behavior, the best way to help the Zed team debug is by reaching for the `agent: open thread as markdown` action and attaching that data as part of your issue on GitHub.

This action exposes all the thread in form of Markdown and allows for deeper understanding of what each tool call was doing.

You can also open threads as Markdown by clicking on the file icon button, to the right of the thumbs down button, when focused on the panel's editor.

## Feedback

Every change we make to Zed's system prompt and tool set, needs to be backed by an eval with good scores.
Every time the LLM performs a weird change or investigate a certain topic in your codebase completely incorrectly, it's an indication that there's an improvement opportunity.

The best way you can help influence the next change to Zed's system prompt and tools is by rating the LLM's response via the thumbs up/down buttons at the end of every response.
In case of a thumbs down, a new textare will show up where you can add more specifics about what happened.
You can provide feedback on the thread at any point after the agent responds, and multiple times within the same thread.

> Note that rating threads does send your data to Zed's servers.
> So, if you don't want that to happen, it is probably better to not rate it, despite it being helpful to us.
> For more information about Zed's approach to AI privacy and security, [check out the dedicated page](/ai/privacy-and-security.md).
